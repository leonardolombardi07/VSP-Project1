function [x, xdot, x2dot] = solve_by_laplace(times, m, c, k)
    % Analytical Method using Laplace Transform
    %--------------------------------------------------------------------------
    % Solves a 1-DOF system with an equivalent mass "m", spring stiffness "k" and damping
    % coeffiecient "c" subjected to an external force F(t) using Laplace Transforms.
    % Returns the displacement, velocity and acceleration of the system with
    % respect to an inertial frame of reference.
    %
    % Input
    % ----------
    %       [times]:        Time Vector             [n, 1]
    %
    % Output
    % ----------
    %       [x]:        Displacement Response   [n,1]
    %       [xdot]:     Velocity                [n,1]
    %       [x2dot]:    Acceleration            [n,1]
    syms x t s;

    F = 200 + (100 - 500 * t) * heaviside(t - 0.2) + (500 * t - 300) * heaviside(t - 0.4);
    F_laplace = laplace(F, t, s);
    X_laplace = F_laplace / (m * s^2 + c * s + k);

    x_of_t = ilaplace(X_laplace);
    xdot_of_t = diff(x_of_t, t);
    x2dot_of_t = diff(xdot_of_t, t);

    % Not sure how to use this functions to calculate x, xdot and x2dot
    % as they handle symbolic variables
    get_x = @(t) 100 * heaviside(t - 2/5) * ((exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1097686559)) / 1100 - 1/1100) - 500 * heaviside(t - 1/5) * (t / 1100 + (1521 * exp(1521/5000 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 1/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1669581256239)) / 605000000 - 111521/605000000) + 500 * heaviside(t - 2/5) * (t / 1100 + (1521 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1669581256239)) / 605000000 - 221521/605000000) - (2 * exp(-(1521 * t) / 1000) * (cos((1097686559^(1/2) * t) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * t) / 1000)) / 1097686559)) / 11 + 2/11;
    get_xdot = @(t) 500 * heaviside(t - 1/5) * ((1521 * exp(1521/5000 - (1521 * t) / 1000) * ((547686559 * cos((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1521000 + (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1000)) / 605000000 + (2313441 * exp(1521/5000 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 1/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1669581256239)) / 605000000000 - 1/1100) - 500 * heaviside(t - 2/5) * ((1521 * exp(1521/2500 - (1521 * t) / 1000) * ((547686559 * cos((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1521000 + (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000)) / 605000000 + (2313441 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1669581256239)) / 605000000000 - 1/1100) + 100 * dirac(t - 2/5) * ((exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1097686559)) / 1100 - 1/1100) - (2 * exp(-(1521 * t) / 1000) * ((1521 * cos((1097686559^(1/2) * t) / 1000)) / 1000 - (1097686559^(1/2) * sin((1097686559^(1/2) * t) / 1000)) / 1000)) / 11 - 100 * heaviside(t - 2/5) * ((1521 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1097686559)) / 1100000 - (exp(1521/2500 - (1521 * t) / 1000) * ((1521 * cos((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000 - (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000)) / 1100) - 500 * dirac(t - 1/5) * (t / 1100 + (1521 * exp(1521/5000 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 1/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1669581256239)) / 605000000 - 111521/605000000) + 500 * dirac(t - 2/5) * (t / 1100 + (1521 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1669581256239)) / 605000000 - 221521/605000000) + (1521 * exp(-(1521 * t) / 1000) * (cos((1097686559^(1/2) * t) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * t) / 1000)) / 1097686559)) / 5500;
    get_x2dot = @(t) 100 * dirac(1, t - 2/5) * ((exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1097686559)) / 1100 - 1/1100) + (1521 * exp(-(1521 * t) / 1000) * ((1521 * cos((1097686559^(1/2) * t) / 1000)) / 1000 - (1097686559^(1/2) * sin((1097686559^(1/2) * t) / 1000)) / 1000)) / 2750 - 200 * dirac(t - 2/5) * ((1521 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1097686559)) / 1100000 - (exp(1521/2500 - (1521 * t) / 1000) * ((1521 * cos((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000 - (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000)) / 1100) + (2 * exp(-(1521 * t) / 1000) * ((1097686559 * cos((1097686559^(1/2) * t) / 1000)) / 1000000 + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * t) / 1000)) / 1000000)) / 11 - 500 * dirac(1, t - 1/5) * (t / 1100 + (1521 * exp(1521/5000 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 1/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1669581256239)) / 605000000 - 111521/605000000) + 500 * dirac(1, t - 2/5) * (t / 1100 + (1521 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1669581256239)) / 605000000 - 221521/605000000) + 500 * heaviside(t - 2/5) * ((2313441 * exp(1521/2500 - (1521 * t) / 1000) * ((547686559 * cos((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1521000 + (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000)) / 302500000000 + (3518743761 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1669581256239)) / 605000000000000 - (1521 * exp(1521/2500 - (1521 * t) / 1000) * ((1097686559 * cos((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000000 - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1521000000)) / 605000000) - 500 * heaviside(t - 1/5) * ((2313441 * exp(1521/5000 - (1521 * t) / 1000) * ((547686559 * cos((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1521000 + (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1000)) / 302500000000 + (3518743761 * exp(1521/5000 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 1/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1669581256239)) / 605000000000000 - (1521 * exp(1521/5000 - (1521 * t) / 1000) * ((1097686559 * cos((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1000000 - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1521000000)) / 605000000) - (2313441 * exp(-(1521 * t) / 1000) * (cos((1097686559^(1/2) * t) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * t) / 1000)) / 1097686559)) / 5500000 - 1000 * dirac(t - 2/5) * ((1521 * exp(1521/2500 - (1521 * t) / 1000) * ((547686559 * cos((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1521000 + (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000)) / 605000000 + (2313441 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1669581256239)) / 605000000000 - 1/1100) + 1000 * dirac(t - 1/5) * ((1521 * exp(1521/5000 - (1521 * t) / 1000) * ((547686559 * cos((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1521000 + (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1000)) / 605000000 + (2313441 * exp(1521/5000 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 1/5)) / 1000) - (547686559 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 1/5)) / 1000)) / 1669581256239)) / 605000000000 - 1/1100) - 100 * heaviside(t - 2/5) * ((1521 * exp(1521/2500 - (1521 * t) / 1000) * ((1521 * cos((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000 - (1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000)) / 550000 - (2313441 * exp(1521/2500 - (1521 * t) / 1000) * (cos((1097686559^(1/2) * (t - 2/5)) / 1000) + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1097686559)) / 1100000000 + (exp(1521/2500 - (1521 * t) / 1000) * ((1097686559 * cos((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000000 + (1521 * 1097686559^(1/2) * sin((1097686559^(1/2) * (t - 2/5)) / 1000)) / 1000000)) / 1100);

    x = zeros(length(times), 1); xdot = x; x2dot = x;

    for i = 1:length(times)
        x(i) = get_x(times(i));
        xdot(i) = get_xdot(times(i));
        x2dot(i) = get_x2dot(times(i));
    end

end
